t = int(input()) for _ in range(t):    n, x, k = map(int, input().split())    s = input()     pos = x    time1 = -1     for i in range(n):        if s[i] == 'L':            pos -= 1        else:            pos += 1        if pos == 0:            time1 = i + 1              break       if time1 == -1 or time1 > k:        print(0)        continue     count = 1    remaining = k - time1     pos = 0    time2 = -1     for i in range(n):        if s[i] == 'L':            pos -= 1        else:            pos += 1         if pos == 0:            time2 = i + 1            break         if time2 == -1:        print(count)        continue     cycles = remaining // time2    count += cycles     print(count)